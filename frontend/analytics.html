<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title data-i18n="analytics.pageTitle">Analytics - EngiSuite</title>
    <link rel="stylesheet" href="shared/css/universal-theme.css">
    <link rel="stylesheet" href="shared/css/mobile-responsive.css">
    <link rel="stylesheet" href="shared/css/analytics.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="shared/js/tailwind-config.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#2a5298',
                            dark: '#1e3c72',
                            text: '#2c3e50',
                            light: '#f5f7fa',
                            accent: '#3498db',
                            success: '#2ecc71',
                            warning: '#f39c12',
                            danger: '#e74c3c',
                        }
                    }
                }
            }
        }
    </script>
</head>

<body class="font-sans antialiased text-brand-text bg-gray-50 h-screen flex overflow-hidden">
    <!-- Sidebar (loaded dynamically) -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col min-w-0 overflow-hidden bg-gray-50">
        <!-- Header (loaded dynamically) -->
        <div id="header-container"></div>

        <!-- Analytics Content -->
        <div class="flex-1 overflow-y-auto w-full p-3 sm:p-4 lg:p-6">
            <div class="max-w-7xl mx-auto">
                <!-- Page Header -->
                <div class="mb-4 sm:mb-6">
                    <h1 class="text-xl sm:text-2xl font-bold text-brand-text" data-i18n="analytics.pageTitle">Analytics
                    </h1>
                    <p class="text-sm text-slate-500 mt-1" data-i18n="analytics.pageDescription">Comprehensive data
                        analysis and visualization tools</p>
                </div>

                <!-- Tabs Navigation -->
                <div class="tabs-container mb-4 sm:mb-6 overflow-x-auto -mx-3 px-3 sm:mx-0 sm:px-0">
                    <div class="tabs flex gap-1 sm:gap-2 min-w-max">
                        <button
                            class="tab-link active px-3 sm:px-4 py-2 sm:py-3 text-sm font-medium rounded-lg whitespace-nowrap"
                            data-tab="query-builder" data-i18n="analytics.tabs.queryBuilder">Query Builder</button>
                        <button
                            class="tab-link px-3 sm:px-4 py-2 sm:py-3 text-sm font-medium rounded-lg whitespace-nowrap"
                            data-tab="data-upload" data-i18n="analytics.tabs.dataUpload">Data Upload</button>
                        <button
                            class="tab-link px-3 sm:px-4 py-2 sm:py-3 text-sm font-medium rounded-lg whitespace-nowrap"
                            data-tab="data-analysis" data-i18n="analytics.tabs.dataAnalysis">Data Analysis</button>
                        <button
                            class="tab-link px-3 sm:px-4 py-2 sm:py-3 text-sm font-medium rounded-lg whitespace-nowrap"
                            data-tab="pivot-table" data-i18n="analytics.tabs.pivotTable">Pivot Table</button>
                        <button
                            class="tab-link px-3 sm:px-4 py-2 sm:py-3 text-sm font-medium rounded-lg whitespace-nowrap"
                            data-tab="dashboard" data-i18n="analytics.tabs.dashboard">Dashboard</button>
                    </div>
                </div>

                <!-- Tab Content -->
                <div class="tab-content active" id="query-builder">
                    <div class="query-builder-container">
                        <div class="database-connection">
                            <h3 data-i18n="analytics.databaseConnection">Database Connection</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="db-type" data-i18n="analytics.dbType">Database Type:</label>
                                    <select id="db-type">
                                        <option value="mysql" data-i18n="analytics.dbMySql">MySQL</option>
                                        <option value="postgresql" data-i18n="analytics.dbPostgreSQL">PostgreSQL
                                        </option>
                                        <option value="sqlite" data-i18n="analytics.dbSqlite">SQLite</option>
                                        <option value="mongodb" data-i18n="analytics.dbMongoDB">MongoDB</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="db-host" data-i18n="analytics.dbHost">Host:</label>
                                    <input type="text" id="db-host" placeholder="localhost">
                                </div>
                                <div class="form-group">
                                    <label for="db-port" data-i18n="analytics.dbPort">Port:</label>
                                    <input type="text" id="db-port" placeholder="3306">
                                </div>
                                <div class="form-group">
                                    <label for="db-name" data-i18n="analytics.dbName">Database:</label>
                                    <input type="text" id="db-name" placeholder="engineering_db">
                                </div>
                                <div class="form-group">
                                    <label for="db-user" data-i18n="analytics.dbUser">Username:</label>
                                    <input type="text" id="db-user" placeholder="root">
                                </div>
                                <div class="form-group">
                                    <label for="db-password" data-i18n="analytics.dbPassword">Password:</label>
                                    <input type="password" id="db-password" placeholder="••••••••">
                                </div>
                            </div>
                            <button id="connect-db" class="btn-primary" data-i18n="analytics.connect">Connect</button>
                        </div>

                        <div id="query-section" class="query-section" style="display: none;">
                            <h3 data-i18n="analytics.queryBuilder">Query Builder</h3>
                            <div class="query-container">
                                <div class="query-textarea">
                                    <textarea id="query-text" placeholder="Enter SQL query here..."></textarea>
                                </div>
                                <div class="query-actions">
                                    <button id="execute-query" class="btn-primary"
                                        data-i18n="analytics.executeQuery">Execute</button>
                                    <button id="export-query" class="btn-secondary"
                                        data-i18n="analytics.exportResults">Export</button>
                                </div>
                            </div>

                            <div class="database-tables">
                                <h4 data-i18n="analytics.databaseTables">Database Tables</h4>
                                <ul id="database-tables"></ul>
                            </div>

                            <div class="query-results">
                                <h4 data-i18n="analytics.queryResults">Query Results</h4>
                                <div class="results-stats">
                                    <span id="results-count" data-i18n="analytics.resultsCount">0 results</span>
                                    <span id="execution-time" data-i18n="analytics.executionTime">0.00 seconds</span>
                                </div>
                                <table id="results-table" class="results-table"></table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="data-upload">
                    <div class="data-upload-container">
                        <h3 data-i18n="analytics.uploadData">Upload Data</h3>
                        <p data-i18n="analytics.uploadDescription">Upload CSV, Excel, or JSON files for analysis</p>

                        <div class="upload-section">
                            <div id="drop-zone" class="drop-zone">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p data-i18n="analytics.dropFiles">Drag and drop files here</p>
                                <p data-i18n="analytics.orClick">or click to browse</p>
                                <input type="file" id="file-upload" accept=".csv,.xlsx,.xls,.json" multiple>
                            </div>

                            <div id="selected-files" class="selected-files"></div>

                            <button id="process-files" class="btn-primary" data-i18n="analytics.processFiles"
                                disabled>Process
                                Files</button>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="data-analysis">
                    <div class="data-analysis-container">
                        <h3 data-i18n="analytics.dataAnalysis">Data Analysis</h3>
                        <p data-i18n="analytics.analysisDescription">Analyze your data with powerful visualization tools
                        </p>

                        <div class="analysis-config">
                            <div class="form-group">
                                <label for="dataset-select" data-i18n="analytics.selectDataset">Select Dataset:</label>
                                <select id="dataset-select">
                                    <option value="">-- Select Dataset --</option>
                                    <option value="sales" data-i18n="analytics.datasetSales">Sales Data</option>
                                    <option value="inventory" data-i18n="analytics.datasetInventory">Inventory Data
                                    </option>
                                    <option value="projects" data-i18n="analytics.datasetProjects">Project Data</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="column-select" data-i18n="analytics.selectColumn">Select Column:</label>
                                <select id="column-select">
                                    <option value="">-- Select Column --</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="chart-type" data-i18n="analytics.selectChartType">Chart Type:</label>
                                <select id="chart-type">
                                    <option value="line" data-i18n="analytics.chartLine">Line Chart</option>
                                    <option value="bar" data-i18n="analytics.chartBar">Bar Chart</option>
                                    <option value="pie" data-i18n="analytics.chartPie">Pie Chart</option>
                                    <option value="doughnut" data-i18n="analytics.chartDoughnut">Doughnut Chart</option>
                                    <option value="radar" data-i18n="analytics.chartRadar">Radar Chart</option>
                                </select>
                            </div>

                            <button id="generate-chart" class="btn-primary" data-i18n="analytics.generateChart"
                                disabled>Generate Chart</button>
                            <button id="download-chart" class="btn-secondary"
                                data-i18n="analytics.downloadChart">Download
                                Chart</button>
                        </div>

                        <div class="chart-container">
                            <canvas id="analysis-chart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="pivot-table">
                    <div class="pivot-container">
                        <h3 data-i18n="analytics.pivotTable">Pivot Table</h3>
                        <p data-i18n="analytics.pivotDescription">Create dynamic pivot tables for data summarization</p>

                        <div id="pivot-config" class="pivot-config">
                            <div class="form-group">
                                <label for="pivot-rows" data-i18n="analytics.pivotRows">Rows:</label>
                                <select id="pivot-rows" multiple>
                                    <option value="category" data-i18n="analytics.pivotCategory">Category</option>
                                    <option value="region" data-i18n="analytics.pivotRegion">Region</option>
                                    <option value="month" data-i18n="analytics.pivotMonth">Month</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="pivot-columns" data-i18n="analytics.pivotColumns">Columns:</label>
                                <select id="pivot-columns" multiple>
                                    <option value="year" data-i18n="analytics.pivotYear">Year</option>
                                    <option value="quarter" data-i18n="analytics.pivotQuarter">Quarter</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="pivot-values" data-i18n="analytics.pivotValues">Values:</label>
                                <select id="pivot-values">
                                    <option value="sum" data-i18n="analytics.pivotSum">Sum</option>
                                    <option value="count" data-i18n="analytics.pivotCount">Count</option>
                                    <option value="avg" data-i18n="analytics.pivotAverage">Average</option>
                                </select>
                            </div>
                        </div>

                        <div class="pivot-actions">
                            <button id="refresh-pivot" class="btn-primary"
                                data-i18n="analytics.refreshPivot">Refresh</button>
                            <button id="export-pivot" class="btn-secondary"
                                data-i18n="analytics.exportPivot">Export</button>
                        </div>

                        <div id="pivot-container" class="pivot-table-container"></div>
                    </div>
                </div>

                <div class="tab-content" id="dashboard">
                    <div class="dashboard-container">
                        <h3 data-i18n="analytics.dashboard">Analytics Dashboard</h3>
                        <p data-i18n="analytics.dashboardDescription">Visual overview of key metrics and trends</p>

                        <div class="dashboard-controls">
                            <div class="form-group">
                                <label for="date-range" data-i18n="analytics.dateRange">Date Range:</label>
                                <select id="date-range">
                                    <option value="7d" data-i18n="analytics.date7Days">Last 7 Days</option>
                                    <option value="30d" data-i18n="analytics.date30Days">Last 30 Days</option>
                                    <option value="90d" data-i18n="analytics.date90Days">Last 90 Days</option>
                                    <option value="1y" data-i18n="analytics.date1Year">Last Year</option>
                                </select>
                            </div>

                            <button id="refresh-dashboard" class="btn-primary"
                                data-i18n="analytics.refreshDashboard">Refresh</button>
                        </div>

                        <div class="dashboard-grid">
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h4 data-i18n="analytics.totalRevenue">Total Revenue</h4>
                                </div>
                                <div class="card-value">$1,234,567</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i> 12.5%
                                </div>
                            </div>

                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h4 data-i18n="analytics.totalSales">Total Sales</h4>
                                </div>
                                <div class="card-value">45,678</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i> 8.2%
                                </div>
                            </div>

                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h4 data-i18n="analytics.activeProjects">Active Projects</h4>
                                </div>
                                <div class="card-value">342</div>
                                <div class="card-change negative">
                                    <i class="fas fa-arrow-down"></i> 3.1%
                                </div>
                            </div>

                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h4 data-i18n="analytics.averageResponse">Average Response Time</h4>
                                </div>
                                <div class="card-value">2.4s</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i> 15.8%
                                </div>
                            </div>
                        </div>

                        <div class="charts-section">
                            <div class="chart-wrapper">
                                <canvas id="dashboard-chart-sales"></canvas>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="dashboard-chart-revenue"></canvas>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="dashboard-chart-categories"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scripts -->
            <script src="shared/js/theme-manager.js"></script>
            <script src="shared/js/i18n.js"></script>
            <script src="shared/js/auth.js"></script>
            <script src="shared/js/page-init.js"></script>
            <script src="shared/js/utils.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script type="module" src="shared/js/analytics-app.js"></script>

            <script>
                // Initialize page
                document.addEventListener('DOMContentLoaded', function () {
                    // Load user data
                    authService.init();

                    // Initialize analytics app
                    if (typeof analyticsApp !== 'undefined') {
                        analyticsApp.initialize();
                    }
                });
            </script>
</body>

</html>